<?xml version="1.0"?>
<tool id="bcftools_@EXECUTABLE@" name="bcftools @EXECUTABLE@" version="@VERSION@.0">
  <description>VCF/BCF conversion, view, subset and filter VCF/BCF files.</description>
  <macros>
    <token name="@EXECUTABLE@">view</token>
    <import>macros.xml</import>
  </macros>
  <expand macro="requirements"/>
  <expand macro="stdio"/>
  <expand macro="version_command"/>
  <command>bcftools @EXECUTABLE@

## Filter section
#if $sec_filter.min_ac:
  --min-ac "${sec_filter.min_ac}"
#end if
#if $sec_filter.max_ac:
  --max-ac "${sec_filter.max_ac}"
#end if
#set values_sec_filter_apply_filters = '","'.join([str($value) for $value in $sec_filter.apply_filters_repeat])
#if $values_sec_filter_apply_filters:
  --apply-filters "${values_sec_filter_apply_filters}"
#end if
#if str($sec_filter.select_genotype) != "__none__":
  --genotype "${sec_filter.select_genotype}"
#end if
#if $sec_filter.include:
  --include "${sec_filter.include}"
#end if
#if $sec_filter.exclude:
  --exclude "${sec_filter.exclude}"
#end if
${sec_filter.known}
${sec_filter.novel}
#if $sec_filter.min_alleles:
  --min-alleles "${sec_filter.min_alleles}"
#end if
#if $sec_filter.max_alleles:
  --max-alleles "${sec_filter.max_alleles}"
#end if
${sec_filter.phased_exclude_phased}
#if $sec_filter.min_af:
  --min-af "${sec_filter.min_af}"
#end if
#if $sec_filter.max_af:
  --max-af "${sec_filter.max_af}"
#end if
${sec_filter.uncalled_exclude_uncalled}
#set values_sec_filter_types_exclude_types = '","'.join([str($value) for $value in $sec_filter.types_exclude_types_repeat])
#if $values_sec_filter_types_exclude_types:
  --types_exclude-types "${values_sec_filter_types_exclude_types}"
#end if
${sec_filter.private_exclude_private}

## Output section
${sec_output.drop_genotypes}
${sec_output.header_only}
${sec_output.no_header}
#if $sec_output.compression_level:
  --compression-level "${sec_output.compression_level}"
#end if
#if $sec_output.output_file:
  --output-file "${sec_output.output_file}"
#end if
#if str($sec_output.select_output_type) != "__none__":
  --output-type "${sec_output.select_output_type}"
#end if
#set values_sec_output_regions = '","'.join([str($value) for $value in $sec_output.regions_repeat])
#if $values_sec_output_regions:
  --regions "${values_sec_output_regions}"
#end if
#if $sec_output.regions_file:
  --regions-file "${sec_output.regions_file}"
#end if
#set values_sec_output_targets = '","'.join([str($value) for $value in $sec_output.targets_repeat])
#if $values_sec_output_targets:
  --targets "${values_sec_output_targets}"
#end if
#if $sec_output.targets_file:
  --targets-file "${sec_output.invert_targets_file}${sec_output.targets_file}"
#end if

## Subset section
${sec_subset.trim_alt_alleles}
${sec_subset.no_update}
#set values_sec_subset_samples = '","'.join([str($value) for $value in $sec_subset.samples_repeat])
#if $values_sec_subset_samples:
  --samples "${sec_subset.invert_samples}${values_sec_subset_samples}"
#end if
#if $sec_subset.samples_file:
  --samples-file "${sec_subset.invert_samples_file}${sec_subset.samples_file}"
#end if
${sec_subset.force_samples}

## Primary Input/Outputs

$input_file
&gt;
$output_file</command>
  <inputs>
    <param format="vcf,bcf" label="VCF/BCF Data" name="input_file" type="data"/>
    <section expanded="true" name="sec_filter" title="Filter Options">
      <param default="nref" help="minimum/maximum count for non-reference (nref), 1st alternate (alt1), least frequent (minor), most frequent (major) or sum of all but most frequent (nonmajor) alleles" label="Min Ac" name="min_ac" optional="True" type="integer"/>
      <param default="nref" help="minimum/maximum count for non-reference (nref), 1st alternate (alt1), least frequent (minor), most frequent (major) or sum of all but most frequent (nonmajor) alleles" label="Max Ac" name="max_ac" optional="True" type="integer"/>
      <expand macro="macro_apply_filters_repeat"/>
      <param name="select_genotype" type="select">
        <option selected="True" value="__none__">No selection</option>
        <option value="require one or more hom/het/missing genotype or"/>
        <option value="if prefixed with &quot;^&quot;"/>
        <option value="exclude sites with hom/het/missing genotypes"/>
      </param>
      <param __TODO__="TODO" help="select/exclude sites for which the expression is true (see man page for details)" label="Include" name="include"/>
      <param __TODO__="TODO" help="select/exclude sites for which the expression is true (see man page for details)" label="Exclude" name="exclude"/>
      <param falsevalue="" help="select known/novel sites only (ID is not/is '.')" label="Known" name="known" truevalue="--known" type="boolean"/>
      <param falsevalue="" help="select known/novel sites only (ID is not/is '.')" label="Novel" name="novel" truevalue="--novel" type="boolean"/>
      <param help="minimum/maximum number of alleles listed in REF and ALT (e.g. -m2 -M2 for biallelic sites)" label="Min Alleles" name="min_alleles" optional="True" type="integer"/>
      <param help="minimum/maximum number of alleles listed in REF and ALT (e.g. -m2 -M2 for biallelic sites)" label="Max Alleles" name="max_alleles" optional="True" type="integer"/>
      <param falsevalue="--exclude-phased" help="select/exclude sites where all samples are phased" label="Phased/Exclude Phased" name="phased_exclude_phased" truevalue="--phased" type="boolean"/>
      <param default="nref" help="minimum/maximum frequency for non-reference (nref), 1st alternate (alt1), least frequent (minor), most frequent (major) or sum of all but most frequent (nonmajor) alleles" label="Min Af" name="min_af" optional="True" type="float"/>
      <param default="nref" help="minimum/maximum frequency for non-reference (nref), 1st alternate (alt1), least frequent (minor), most frequent (major) or sum of all but most frequent (nonmajor) alleles" label="Max Af" name="max_af" optional="True" type="float"/>
      <param falsevalue="--exclude-uncalled" help="select/exclude sites without a called genotype" label="Uncalled/Exclude Uncalled" name="uncalled_exclude_uncalled" truevalue="--uncalled" type="boolean"/>
      <repeat name="types_exclude_types_repeat" title="Types_Exclude Types">
        <param help="select/exclude comma-separated list of variant types: snps,indels,mnps,other [null]" label="Types_Exclude Types" name="types_exclude_types"/>
      </repeat>
      <param falsevalue="--exclude-private" help="select/exclude sites where the non-reference alleles are exclusive (private) to the subset samples" label="Private/Exclude Private" name="private_exclude_private" truevalue="--private" type="boolean"/>
    </section>
    <section expanded="true" name="sec_output" title="Output Options">
      <param falsevalue="" help="drop individual genotype information (after subsetting if -s option set)" label="Drop Genotypes" name="drop_genotypes" truevalue="--drop-genotypes" type="boolean"/>
      <param falsevalue="" help="print the header only/suppress the header in VCF output" label="Header Only" name="header_only" truevalue="--header-only" type="boolean"/>
      <param falsevalue="" help="print the header only/suppress the header in VCF output" label="No Header" name="no_header" truevalue="--no-header" type="boolean"/>
      <param __TODO__="TODO" help="compression level: 0 uncompressed, 1 best speed, 9 best compression [-1]" label="Compression Level" name="compression_level"/>
      <expand macro="macro_output_file"/>
      <expand macro="macro_select_output_type"/>
      <expand macro="macro_regions_repeat"/>
      <expand macro="macro_regions_file"/>
      <expand macro="macro_targets_repeat"/>
      <param format="data" help="similar to -R but streams rather than index-jumps. Exclude regions with &quot;^&quot; prefix" label="Targets File" name="targets_file" optional="True" type="data"/>
      <param falsevalue="" help="inverts the query/filtering applied by Targets File" label="Invert Targets File" name="invert_targets_file" truevalue="^" type="boolean"/>
    </section>
    <section expanded="true" name="sec_subset" title="Subset Options">
      <param falsevalue="" help="trim alternate alleles not seen in the subset" label="Trim Alt Alleles" name="trim_alt_alleles" truevalue="--trim-alt-alleles" type="boolean"/>
      <param falsevalue="" help="do not (re)calculate INFO fields for the subset (currently INFO/AC and INFO/AN)" label="No Update" name="no_update" truevalue="--no-update" type="boolean"/>
      <expand macro="macro_samples_repeat"/>
      <expand macro="macro_invert_samples"/>
      <param format="data" help="file of samples to include (or exclude with &quot;^&quot; prefix)" label="Samples File" name="samples_file" optional="True" type="data"/>
      <expand macro="macro_invert_samples_file"/>
      <param falsevalue="" help="only warn about unknown subset samples" label="Force Samples" name="force_samples" truevalue="--force-samples" type="boolean"/>
    </section>
  </inputs>
  <outputs>
    <data format="vcf" name="output_file">
      <change_format>
        <when format="bcf_bgz" input="sec_output|select_output_type" value="b"/>
        <when format="bcf" input="sec_output|select_output_type" value="u"/>
        <when format="vcf_bgz" input="sec_output|select_output_type" value="z"/>
        <when format="vcf" input="sec_output|select_output_type" value="v"/>
      </change_format>
    </data>
  </outputs>
  <tests/>
  <help>VCF/BCF conversion, view, subset and filter VCF/BCF files.</help>
  <expand macro="citations"/>
</tool>
