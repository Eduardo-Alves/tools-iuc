<?xml version="1.0"?>
<tool id="bcftools_@EXECUTABLE@" name="bcftools @EXECUTABLE@" version="@VERSION@.0">
  <description>Merge multiple VCF/BCF files from non-overlapping sample sets to create one multi-sample file</description>
  <macros>
    <token name="@EXECUTABLE@">merge</token>
    <import>macros.xml</import>
  </macros>
  <expand macro="requirements"/>
  <expand macro="stdio"/>
  <expand macro="version_command"/>
  <command>bcftools @EXECUTABLE@

## Default section
${sec_default.force_samples}
${sec_default.print_header}
#if $sec_default.use_header:
  --use-header "${sec_default.use_header}"
#end if
#set values_sec_default_apply_filters = '","'.join([str($value) for $value in $sec_default.apply_filters_repeat])
#if $values_sec_default_apply_filters:
  --apply-filters "${values_sec_default_apply_filters}"
#end if
#if $sec_default.info_rules:
  --info-rules "${sec_default.info_rules}"
#end if
#if $sec_default.file_list:
  --file-list "${sec_default.file_list}"
#end if
#if $sec_default.merge:
  --merge "${sec_default.merge}"
#end if
#if $sec_default.output:
  --output "${sec_default.output}"
#end if
#if str($sec_default.select_output_type) != "__none__":
  --output-type "${sec_default.select_output_type}"
#end if
#set values_sec_default_regions = '","'.join([str($value) for $value in $sec_default.regions_repeat])
#if $values_sec_default_regions:
  --regions "${values_sec_default_regions}"
#end if
#if $sec_default.regions_file:
  --regions-file "${sec_default.regions_file}"
#end if

## Primary Input/Outputs

</command>
  <inputs>
    <param format="vcf,bcf" label="VCF/BCF Data" name="input_file1" type="data"/>
    <param format="vcf,bcf" label="Other VCF/BCF Datasets" multiple="True" name="input_file2" type="data"/>
    <section expanded="true" name="sec_default" title="Default Options">
      <param falsevalue="" help="resolve duplicate sample names" label="Force Samples" name="force_samples" truevalue="--force-samples" type="boolean"/>
      <param falsevalue="" help="print only the merged header and exit" label="Print Header" name="print_header" truevalue="--print-header" type="boolean"/>
      <param format="data" help="use the provided header" label="Use Header" name="use_header" optional="True" type="data"/>
      <expand macro="macro_apply_filters_repeat"/>
      <param __TODO__="TODO" help="rules for merging INFO fields (method is one of sum,avg,min,max,join) or &quot;-&quot; to turn off the default [DP:sum,DP4:sum]" label="Info Rules" name="info_rules"/>
      <param format="data" help="read file names from the file" label="File List" name="file_list" optional="True" type="data"/>
      <param help="allow multiallelic records for &lt;snps|indels|both|all|none|id&gt;, see man page for details [both]" label="Merge" name="merge" optional="True" type="string"/>
      <expand macro="macro_output"/>
      <expand macro="macro_select_output_type"/>
      <expand macro="macro_regions_repeat"/>
      <expand macro="macro_regions_file"/>
    </section>
  </inputs>
  <outputs>
    <data format="vcf" name="output_file">
      <change_format>
        <when format="bcf_bgz" input="sec_default|select_output_type" value="b"/>
        <when format="bcf" input="sec_default|select_output_type" value="u"/>
        <when format="vcf_bgz" input="sec_default|select_output_type" value="z"/>
        <when format="vcf" input="sec_default|select_output_type" value="v"/>
      </change_format>
    </data>
  </outputs>
  <tests/>
  <help>Merge multiple VCF/BCF files from non-overlapping sample sets to create one multi-sample file. Note that only records from different files can be merged, never from the same file. For "vertical" merge take a look at "bcftools norm" instead.</help>
  <expand macro="citations"/>
</tool>
