<?xml version="1.0"?>
<macros>
  <xml name="requirements">
    <requirements>
      <requirement type="package" version="1.11.6">jbrowse</requirement>
      <requirement type="package" version="2.7">python</requirement>
      <requirement type="package" version="5.18">perl</requirement>
      <requirement type="package" version="1.2">samtools</requirement>
      <requirement type="package" version="1.0">bundle_jbrowse</requirement>
      <requirement type="package" version="3.11">pyyaml</requirement>
      <yield/>
    </requirements>
  </xml>
  <token name="@WRAPPER_VERSION@">1.0</token>
  <xml name="stdio">
    <stdio>
      <exit_code range="1:"/>
      <exit_code range=":-1"/>
      <regex match="Error:"/>
      <regex match="Exception:"/>
    </stdio>
  </xml>
  <token name="@ATTRIBUTION@"><![CDATA[
**Attribution**

This Galaxy tool relies on the JBrowse, maintained by the GMOD Community
]]>
  </token>
  <xml name="colour_selection_minmax">
    <section name="jbcolor" title="JBrowse Color Options [Advanced]" expanded="false">
      <conditional name="color" label="Color">
        <param type="select" label="Color specification" name="color_select">
          <option value="manual" selected="true">Manual colour selection</option>
        </param>
        <when value="manual">
          <param label="JBrowse style.pos_color" type="color" name="style_pos_color" value="blue" help="CSS color, default 'blue'. When drawing bicolor plots, the fill color to use for values that are above the pivot point.">
            <sanitizer>
              <valid initial="string.letters,string.digits">
                <add value="#" />
              </valid>
            </sanitizer>
          </param>
          <param label="JBrowse style.neg_color" type="color" name="style_neg_color" value="red" help=" CSS color, default 'red'. When drawing bicolor plots, the fill color to use for values that are below the pivot point.">
            <sanitizer>
              <valid initial="string.letters,string.digits">
                <add value="#" />
              </valid>
            </sanitizer>
          </param>
        </when>
      </conditional>
      <conditional name="bicolor_pivot" label="Bicolor Pivot">
        <param type="select" label="Bicolor Pivot" name="bicolor_pivot_select">
          <option value="zero" selected="true">Zero</option>
          <option value="mean">Mean</option>
          <option value="custom">Custom Value</option>
        </param>
        <when value="zero" />
        <when value="mean" />
        <when value="custom">
          <param label="JBrowse style.bicolor_pivot" type="float" name="pivot_point" value="0.0" help="Where to change from pos_color to neg_color when drawing bicolor plots." />
        </when>
      </conditional>
    </section>
  </xml>
  <xml name="colour_selection">
    <section name="jbcolor" title="JBrowse Color Options [Advanced]" expanded="false">
      <conditional name="color" label="Color">
        <param type="select" label="Color specification" name="color_select">
          <option value="automatic" selected="true">Automatically selected (Uses Brewer colors)</option>
          <option value="manual">Manual colour selection</option>
        </param>
        <when value="automatic">
        </when>
        <when value="manual">
          <param label="JBrowse style.color" type="color" name="style_color" value="goldenrod" help="Basic color of features. Most glyphs interpret this as the fill color of the rectangle they draw. Color syntax is the same as that used for CSS">
            <sanitizer>
              <valid initial="string.letters,string.digits">
                <add value="#" />
              </valid>
            </sanitizer>
          </param>
        </when>
      </conditional>
      <conditional name="color_score" label="JBrowse style.color &amp; Score relationship">
        <param type="select" label="Color Score Algorithm" name="colour_score_select">
          <option value="score">Based on score</option>
          <option value="none">Ignore score</option>
        </param>
        <when value="score">
            <param type="select" label="JBrowse style.color function's score scaling" name="score_scaling">
              <option value="linear">Linear scaling</option>
              <option value="logarithmic">Logarithmic scaling</option>
            </param>
            <conditional name="color_scheme" label="Color Scheme for scored features">
              <param type="select" label="JBrowse style.color function's color scheme for scored values" name="score_scheme">
                <option value="opacity">Opacity (high scores = 1.0 opacity)</option>
                <option value="brewer">Brewer Color Schemes</option>
              </param>
              <when value="opacity" />
              <when value="brewer">
                <param type="select" label="Brewer Colour Scheme" name="brewer_scheme">
                    <option value="BrBg">BrBg: Brown - Blue Green</option>
                    <option value="PiYg">PiYg: Pink - Yellow Green</option>
                    <option value="PRGn">PRGn: Purple Red - Green</option>
                    <option value="PuOr">PuOr: Purple - Orange</option>
                    <option value="RdBu" selected="true">RdBu: Red - Blue</option>
                    <option value="RdGy">RdGy: Red - Gray</option>
                    <option value="RdYlBu">RdYlBu: Red - Yellow - Blue</option>
                    <option value="RdYlGn">RdYlBu: Red - Yellow - Green</option>
                    <option value="Spectral">Spectral</option>
                </param>
              </when>
            </conditional>
        </when>
        <when value="none" />
      </conditional>
    </section>
  </xml>
  <xml name="track_styling"
      token_classname="feature"
      token_label="name,id"
      token_description="note,description"
      token_height="100px">
    <section name="jbstyle" title="JBrowse Styling Options [Advanced]" expanded="false">
        <param label="JBrowse style.className" type="text"
            name="style_classname"
            value="@CLASSNAME@"
            help="Set CSS style.className property"/>
        <param label="JBrowse style.label"
            type="text"
            name="style_label"
            value="@LABEL@"
            help="Comma-separated list of case-insensitive feature tags to use for showing the feature's label. The first one found will be used. Default 'name,id'" />
        <param label="JBrowse style.description"
            type="text"
            name="style_description"
            value="@DESCRIPTION@"
            help="Comma-separated list of case-insensitive feature tags to check for the feature's long description. The first one found will be used."/>
        <param label="JBrowse style.height"
            type="text"
            name="style_height"
            value="@HEIGHT@"
            help="Height in pixels of glyphs. Default value varies from glyph to glyph. Note that the 'compact' displayMode uses style->height * 0.35 so changing style height can adjust the compact visualization."/>
    </section>
  </xml>

  <xml name="input_conditional" token_label="Track Data" token_format="data">
      <param label="@LABEL@" format="@FORMAT@" name="annotation" type="data" multiple="True"/>
  </xml>
</macros>
