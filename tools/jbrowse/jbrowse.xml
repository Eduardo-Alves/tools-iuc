<tool id="jbrowse" name="JBrowse" version="0.1">
  <description>genome browser</description>
  <macros>
    <import>macros.xml</import>
  </macros>
  <expand macro="requirements"/>
  <expand macro="stdio"/>
  <version_command>python jbrowse.py --version</version_command>
  <command interpreter="python"><![CDATA[jbrowse.py
$positional_1

#set data_files = '" "'.join([ str($var.annotation) for $var in $data_tracks ])
#set data_formats  = '" "'.join([ str($var.annotation.ext) for $var in $data_tracks ])
#set data_labels = '" "'.join([ str($var.annotation_label) for $var in $data_tracks ])

--annotation "$data_files"
--annotation_format "$data_formats"
--annotation_label "$data_labels"


--jbrowse \${JBROWSE_SOURCE_DIR}
--outdir $default.files_path
> $default]]></command>
  <inputs>
    <param label="Genome" name="positional_1" type="data" format="fasta"/>
    <repeat name="data_tracks" title="Annotation Track">
        <param label="Annotation Data" help="in GFF, GFF3, BED, (Big)Wig, BlastXML, or BAM formats"
            format="gff,gff3,bed,wig,bigwig,bam,blastxml" name="annotation" type="data"/>
      <param label="Dataset Label" name="annotation_label" type="text"/>
    </repeat>
  </inputs>
  <outputs>
    <data format="html" name="default" label="JBrowse on $positional_1.name"/>
  </outputs>
  <help><![CDATA[
Deploy a static JBrowse visualization of a genome and some associated datasets

@ATTRIBUTION@
]]></help>
  <citations>
    <citation type="doi">10.1101/gr.094607.109</citation>
  </citations>
</tool>

