<tool	id="gedlab-khmer-do-partition"
	name="Sequence partition all-in-one"
	version="2.0rc1-1">

	<description>
		Load, partition, and annotate FAST[AQ] sequences
	</description>
        <macros>
                <token name="@BINARY@">do-parition.py</token>
                <import>macros.xml</import>
        </macros>
	<expand macro="requirements" />
	<expand macro="stdio" />
	<expand macro="version" />
	<command><![CDATA[
mkdir -p output;
@BINARY@
@TABLEPARAMS@
@THREADS@
output
#for input in $inputs
$input
#end for ;
mv output.info $infomation ;
mv *.part output/
]]>
	</command>

	<inputs>
		<expand macro="input_sequences_filenames" />
		<param	name="ksize"
			type="integer"
			value="20"
			label="ksize"
			help="k-mer size to use (--ksize/-k)" />
		<param	name="n_tables"
			type="integer"
			min="1"
			value="4"
			label="n_tables"
			help="number of tables to use (--n_tables/-N)" />
		<param	name="tablesize_specific"
			type="text"
			label="tablesize"
			help="lower bound on the tablesize to use (--min-tablesize/-x)" />
	</inputs>
	<outputs>
		<data	name="information"
			format="text"
			label="${tool.name} summary for #echo ','.join(map(str, $inputs ))#" />
		<expand macro="output_sequences" />
	</outputs>
	<tests>
		<test>
                        <param name="inputs" value="random-20-a.fa"/>
			<output name="output">
				<discovered_dataset designation="random-20-a.fa.part">
					<assert_contents>
						<has_text text='>35     2' />
					</assert_contents>
				</discovered_dataset>
                        </output>
                </test>
	</tests>
	<help><![CDATA[
Load in a set of sequences, partition them, merge the partitions, and
annotate the original sequences files with the partition information.

This script combines the functionality of `load-graph.py`,
`partition-graph.py`, `merge-partitions.py`, and
`annotate-partitions.py` into one script. This is convenient
but should probably not be used for large data sets, because
`do-partition.py` doesn't provide save/resume functionality.
]]>
	</help>
	<citations>
		<expand macro="software-citation" />
		<expand macro="graph-citation" />
	</citations>
</tool>
