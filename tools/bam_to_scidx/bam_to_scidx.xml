<tool id="bam_to_scidx" name="Convert BAM to ScIdx" version="1.0.0">
    <description></description>
    <command>
        <![CDATA[
            ln -f -s "${input_bam.metadata.bam_index}" "${input_bam}.bai" &&
            java -jar $__tool_directory__/BAMtoIDX.jar -b "$input_bam" -i "${input_bam}.bai" -s $read -o "$output" 1>/dev/null
        ]]>
    </command>
    <inputs>
        <param name="input_bam" type="data" format="bam" label="BAM file" />
        <param name="read" type="select" label="Read to output">
            <option value="0" selected="True">Read1</option>
            <option value="1">Read2</option>
            <option value="2">Combined</option>
        </param>
    </inputs>
    <outputs>
        <data name="output" format="scidx" />
    </outputs>
    <tests>
        <test>
            <param name="input" value="input.bam" ftype="bam" />
            <param name="read" value="0" />
            <output name="output" file="output.scidx" lines_diff="1" />
        </test>
    </tests>
    <help>

**What it does**

Converts BAM data to ScIdx, the Strand-specific coordinate count format, which is used by tools within
the Chip-exo Galaxy flavor.  ScIdx files are 1-based.  The format consists of 5 columns: the chromosome,
the position of the genomic coordinate, the number of tags on the forward strand, the number of tags on
the reverse strand and the number of total tags on the position.  With pair-end reads, only the 5â€™ end of
READ1 will be used to create the ScIdx data file.  Tools that use this format include GeneTrack and MultiGPS.

    </help>
    <citations>
        <citation type="bibtex">
            @unpublished{None,
            author = {William Lai},
            title = {None},
            year = {None},
            eprint = {None},
            url = {http://www.huck.psu.edu/content/research/independent-centers-excellence/center-for-eukaryotic-gene-regulation}
        }</citation>
    </citations>
</tool>
