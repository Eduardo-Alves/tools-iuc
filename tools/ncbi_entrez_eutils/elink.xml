<?xml version="1.0"?>
<tool id="ncbi.eutils.elink" name="NCBI ELink" version="1.0">
  <description>link UIDs from one database to another</description>
  <macros>
    <import>macros.xml</import>
  </macros>
  <expand macro="requirements"/>
  <expand macro="stdio"/>
  <version_command>python elink.py --version</version_command>
  <command interpreter="python"><![CDATA[elink.py
#if $cmd.cmd_select in ('neighbor', 'neighbor_score', 'neighbor_history'):
$cmd.db_select_to
#else:
"none"
#end if

$db_select_from
$cmd.cmd_select

@LIST_OR_HIST@

#if $cmd.cmd_select == "neighbor_history":
    --history_out $history
#end if

> $default]]></command>
  <inputs>
    <param name="db_select_from" type="select" label="From NCBI Database">
      <option value="assembly">Assembly</option>
      <option value="bioproject">BioProject</option>
      <option value="biosample">BioSample</option>
      <option value="biosystems">Biosystems</option>
      <option value="blastdbinfo">Blast Database Information</option>
      <option value="books">Books</option>
      <option value="cdd">Conserved Domains</option>
      <option value="clinvar">Clinical Variants</option>
      <option value="clone">CLone</option>
      <option value="dbvar">dbVar</option>
      <option value="epigenomics">Epigenomics</option>
      <option value="gap">dbGaP</option>
      <option value="gds">GEO Datasets</option>
      <option value="gene">Gene</option>
      <option value="genome">Genome</option>
      <option value="geoprofiles">GEO Profiles</option>
      <option value="gtr">Genetic Testing Registry</option>
      <option value="homologene">HomoloGene</option>
      <option value="journals">Journals</option>
      <option value="medgen">MedGen</option>
      <option value="mesh">MeSH</option>
      <option value="ncbisearch">NCBI Web Site</option>
      <option value="nlmcatalog">NLM Catalog</option>
      <option value="nuccore">Nucleotide</option>
      <option value="nucest">EST</option>
      <option value="nucgss">GSS</option>
      <option value="omim">OMIM</option>
      <option value="pcassay">PubChem BioAssay</option>
      <option value="pccompound">PubChem Compound</option>
      <option value="pcsubstance">PubChem Substance</option>
      <option value="pmc">PubMed Central</option>
      <option value="popset">PopSet</option>
      <option value="probe">Probe</option>
      <option value="protein">Protein</option>
      <option value="proteinclusters">Protein Clusters</option>
      <option value="pubmed">PubMed</option>
      <option value="pubmedhealth">PubMed Health</option>
      <option value="snp">SNP</option>
      <option value="sra">SRA</option>
      <option value="structure">Structure</option>
      <option value="taxonomy">Taxonomy</option>
      <option value="toolkit">NCBI C++ Toolkit</option>
      <option value="toolkitall">NCBI C++ Toolkit All</option>
      <option value="toolkitbook">NCBI C++ Toolkit Book</option>
      <option value="unigene">UniGene</option>
    </param>
    <conditional name="cmd">
      <param name="cmd_select" type="select" label="ELink command to execute">
        <option value="neighbor">Fetch a set of UIDs in DB linked to input UIDs in DBFROM</option>
        <option value="neighbor_score">Fetch a set of UIDs within the same database as the input UIDs along with computed similarity scores</option>
        <option value="neighbor_history">Fetch a set of UIDs in DB linked to input UIDs from DBFROM, and store on history server</option>
        <option value="acheck">List all links available from a set of UIDs</option>
        <option value="ncheck">Check for the existence of links within the same database for a set of UIDs</option>
        <option value="lcheck">Check for the existence of external links (LinkOuts) for a set of UIDs</option>
        <option value="llinks">For each input UID, list the URLs and attributes for the LinkOut providers that are not libraries</option>
        <option value="llinkslib">For each input UID, list the URLs and attributes for the LinkOut providers (including libraries)</option>
        <option value="prlinks">List the primary LinkOut provider for each input UID</option>
      </param>
      <when value="neighbor">
        <expand macro="db_select_to"/>
      </when>
      <when value="neighbor_score">
        <expand macro="db_select_to"/>
      </when>
      <when value="neighbor_history">
        <expand macro="db_select_to"/>
      </when>
      <when value="acheck"/>
      <when value="ncheck"/>
      <when value="lcheck"/>
      <when value="llinks"/>
      <when value="llinkslib"/>
      <when value="prlinks"/>
    </conditional>
    <expand macro="list_or_hist"/>
  </inputs>
  <outputs>
    <data format="xml" name="default" label="NCBI Linked IDs from $db_select_from"/>
    <expand macro="history_out">
      <filter>cmd['cmd_select'] == 'neighbor_history'</filter>
    </expand>
  </outputs>
  <tests>
    <test>
      <param name="cmd_select" value="neighbor"/>
      <param name="db_select_to" value="pubmed"/>
      <param name="db_select_from" value="taxonomy"/>
      <param name="qss" value="id_list"/>
      <param name="id_list" value="510899"/>
      <output name="default" file="pm-tax-neighbor.xml"/>
    </test>
  </tests>
  <help><![CDATA[
NCBI Entrez ELink
=================

Responds to a list of UIDs in a given database with either a list of related
UIDs (and relevancy scores) in the same database or a list of linked UIDs in
another Entrez database; checks for the existence of a specified link from a
list of one or more UIDs; creates a hyperlink to the primary LinkOut provider
for a specific UID and database, or lists LinkOut URLs and attributes for
multiple UIDs.

@REFERENCES@

@DISCLAIMER@
      ]]></help>
  <expand macro="citations"/>
</tool>
