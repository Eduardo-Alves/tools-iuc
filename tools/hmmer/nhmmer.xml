<?xml version="1.0"?>
<tool id="hmmer.nhmmer" name="nhmmer" version="@WRAPPER_VERSION@.0">
  <description>search a DNA model or alignment against a DNA database</description>
  <macros>
    <import>macros.xml</import>
  </macros>
  <expand macro="requirements"/>
  <expand macro="stdio"/>
  <command><![CDATA[
nhmmer

@OFORMAT_WITH_OPTS_N@
@HSSI@
@THRESHOLDS_NODOM@
@CUT@
@ACCEL_HEUR@
@FORMAT_SELECTOR@
@ADV_OPTS@
@LENGTHS@
@CPU@
@SEED@

$hmmfile
$seqfile
> $output
      ]]></command>
  <inputs>
    <param name="hmmfile" type="data" label="Query HMM file"/>
    <param name="seqfile" type="data" format="fasta" label="Target sequence file"/>
    <expand macro="oformat_with_opts_n"/>
    <expand macro="hssi"/>
    <expand macro="thresholds_nodom"/>
    <expand macro="cut" />
    <expand macro="accel_heur_xml"/>
    <expand macro="format_selector_noprot"/>
    <expand macro="adv_opts"/>
    <expand macro="lengths"/>
    <!-- TODO: block_length toponly bottomonly -->
    <expand macro="seed"/>
  </inputs>
  <outputs>
    <data format="txt" name="output" label="NHMMER search of $seqfile.name in $hmmfile.name"/>

    <data format="tabular" name="tblout" label="Table of per-sequence hits from HMM matches of $seqfile.name in $hmmfile.name">
      <filter>'tblout' in str(oformat)</filter>
    </data>
    <data format="pfam" name="dfamtblout" label="Table of per-sequence/per-domain hits from HMM matches of $seqfile.name in $hmmfile.name">
      <filter>'dfamtblout' in str(oformat)</filter>
    </data>
    <data format="tabular" name="aliscoresout" label="Table of per-domain hits from HMM matches of $seqfile.name in $hmmfile.name">
      <filter>'aliscoresout' in str(oformat)</filter>
    </data>
  </outputs>
  <tests>
    <test>
      <param name="hmmfile" value="MADE1.hmm"/>
      <param name="seqfile" value="dna_target.fa"/>
      <expand macro="oformat_test" />
      <expand macro="seed_test" />
      <output name="output" file="nhmmer.out" lines_diff="160"/>
    </test>
  </tests>
  <help><![CDATA[
**What it does**

profile HMM construction from multiple sequence alignments

@ATTRIBUTION@
]]></help>
  <expand macro="citation"/>
</tool>
