<?xml version="1.0"?>
<tool id="hmmer_hmmscan" name="hmmscan" version="@WRAPPER_VERSION@.0">
  <description>search sequence(s) against a profile database</description>
  <macros>
    <import>macros.xml</import>
  </macros>
  <expand macro="requirements"/>
  <expand macro="stdio"/>
  <command><![CDATA[
hmmpress $hmmdb;
hmmscan

@OFORMAT_WITH_OPTS@
@THRESHOLDS@
@CUT@
@ACCEL_HEUR@
@ADV_OPTS@
@CPU@
@SEED@

$hmmdb
$seqfile
> $output
      ]]></command>
  <inputs>
    <param name="hmmdb" type="data" label="HMMPRESSed HMM model"/>
    <!-- todo use Galaxy features like data libraries/data tables/??? -->
    <param name="seqfile" type="data" format="fasta" label="Sequence file"/>
    <expand macro="oformat_with_opts"/>
    <expand macro="thresholds_xml"/>
    <expand macro="cut"/>
    <expand macro="accel_heur_xml"/>
    <expand macro="adv_opts"/>
    <expand macro="seed"/>
  </inputs>
  <outputs>
    <data format="txt" name="output" label="HMM matches of $seqfile.name in $hmmdb.name"/>
    <data format="tabular" name="tblout" label="Table of per-sequence hits from HMM matches of $seqfile.name in $hmmdb.name">
      <filter>'tblout' in str(oformat)</filter>
    </data>
    <data format="tabular" name="domtblout" label="Table of per-domain hits from HMM matches of $seqfile.name in $hmmdb.name">
      <filter>'domtblout' in str(oformat)</filter>
    </data>
    <data format="pfam" name="pfamtblout" label="Table of per-sequence/per-domain hits from HMM matches of $seqfile.name in $hmmdb.name">
      <filter>'pfamtblout' in str(oformat)</filter>
    </data>
  </outputs>
  <tests>
    <test>
      <param name="hmmdb" value="MADE1.hmm"/>
      <param name="seqfile" value="dna_target.fa"/>
      <expand macro="oformat_test" />
      <expand macro="seed_test" />
      <output name="output" file="MADE1.out" lines_diff="20"/>
      <output name="tblout" file="MADE1.out.tblout" lines_diff="20"/>
      <output name="domtblout" file="MADE1.out.domtblout" lines_diff="20"/>
      <output name="pfamtblout" file="MADE1.out.pfamtblout" lines_diff="20"/>
    </test>
  </tests>
  <help><![CDATA[
@HELP_PRE@

hmmscan is used to search protein sequences against collections of protein
profiles. For each sequence in <seqfile>, use that query sequence to search the
target database of profiles in <hmmdb>, and output ranked lists of the profiles
with the most significant matches to the sequence.

The <seqfile> may contain more than one query sequence. It can be in FASTA
format, or several other common sequence file formats (genbank, embl, and
uniprot, among others), or in alignment file formats (stockholm, aligned fasta,
and others). See the --qformat option for a complete list.

The <hmmdb> needs to be pressâ€™ed using hmmpress before it can be searched with
hmmscan.

@HELP_PRE_OTH@

@OFORMAT_WITH_OPTS_HELP@
@THRESHOLDS_HELP@
@CUT_HELP@
@ACCEL_HEUR_HELP@
@ADV_OPTS_HELP@
@SEED_HELP@

@ATTRIBUTION@
]]></help>
  <expand macro="citation"/>
</tool>
